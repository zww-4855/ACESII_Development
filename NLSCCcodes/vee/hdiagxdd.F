      SUBROUTINE HDIAGXDD(SCR, MAXCOR, IUHF, IRREPX, NSIZEC)
C
C  THE DIAGONAL OF HBAR * DOUBLE COMPONENTS  OF INPUT VECTOR IS CALCULATED.
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      DIMENSION SCR(MAXCOR)
C
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),ID(18)

#ifdef _DEBUG_VEE
      write(*,*) '@VEE: Entered ', __FILE__
#endif

      ONE = 1.0D0
C
      I000 = 1
      I010 = I000 + NSIZEC
      I020 = I010 + NSIZEC
C
      CALL LOADVEC1(IRREPX,SCR,MAXCOR,IUHF,490,0,443,NSIZEC,
     &              .FALSE.)
      CALL GETLST(SCR(I010),1,1,1,1,472)
C
      N1AA = IRPDPD(IRREPX,16)
      IF (IUHF .EQ. 0) THEN
        N1BB = 0
      ELSE
        N1BB = IRPDPD(IRREPX,17)
      ENDIF
      N1 = N1AA + N1BB
C
      CALL VECPRD(SCR(I000+N1),SCR(I010+N1),SCR(I000+N1),NSIZEC-N1)
C
      CALL LOADVEC1(IRREPX,SCR(I010),MAXCOR,IUHF,490,2,460,NSIZEC,
     &              .FALSE.)
      CALL SAXPY(NSIZEC-N1,ONE,SCR(I000+N1),1,SCR(I010+N1),1)
C
      CALL UPDATES(IRREPX,SCR(I010),461,2,490,IUHF)
C
      RETURN
      END
      
