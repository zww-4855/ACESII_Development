      SUBROUTINE R1L2Y2(ICORE,MAXCOR,IUHF)
C
C DRIVER FOR CALCULATING CONTRIBUTIONS OF R2 AND L2 VECTORS
C TO THE Y1 INTERMEDIATE.
C  
CEND
      IMPLICIT INTEGER (A-Z)
      LOGICAL MBPT2,CC,CCD,RCCD,DRCCD,LCCD,LCCSD,CC2
      DIMENSION ICORE(MAXCOR),I0R(2),I0F(2),I0Q(2)
      COMMON/STATSYM/IRREPX
      COMMON/REFTYPE/MBPT2,CC,CCD,RCCD,DRCCD,LCCD,LCCSD,CC2
      COMMON/SYMPOP/IRPDPD(8,22),ISYTYP(2,500),ID(18)
      COMMON/SYM/POP(8,2),VRT(8,2),NT(2),NFMI(2),NFEA(2)
      COMMON/MACHSP/IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
C
      I0R(1)=1
      CALL GETLST(ICORE(I0R(1)),1,1,1,3,490)
      IF(IUHF.NE.0)THEN
       I0R(2)=I0R(1)+IINTFP*IRPDPD(IRREPX,9)
       CALL GETLST(ICORE(I0R(2)),1,1,1,4,490)
      ELSE
       I0R(2)=I0R(1)
      ENDIF 
      I0F(1)=I0R(2)+IINTFP*IRPDPD(IRREPX,10)
      CALL GETLST(ICORE(I0F(1)),1,1,1,1,93)
      IF(IUHF.NE.0)THEN
       I0F(2)=I0F(1)+IINTFP*NT(1)
       CALL GETLST(ICORE(I0F(2)),1,1,1,2,93)
      ELSE
       I0F(2)=I0F(1)
      ENDIF
      I0Q(1)=I0F(2)+IINTFP*NT(2)
      IF(IUHF.NE.0)THEN
       I0Q(2)=I0Q(1)+IINTFP*NT(1)
      ELSE
       I0Q(2)=I0Q(1)
      ENDIF
      I000=I0Q(2)+IINTFP*NT(2)
      MXCOR=MAXCOR-I000+1
C
C CALCULATE Q(AI) = R(ME)*L(IM,AE) INTERMEDIATES AND HOLD IN CORE
C
       CALL GT2XF(ICORE(I0Q(1)),IRREPX,IRREPX,434,490,2,ICORE(I000),
     &            MXCOR,IUHF,0)
C
C CALCULATE CONTRACTIONS
C
C Note that I am assuming RPA is variational. I am not sure (Ajith
C Perera, 04/2014). 
C
       IF(.NOT.(MBPT2.OR.LCCD.OR.LCCSD.OR.RCCD.OR.DRCCD.OR.CC2))
     & THEN
        CALL R1L2Y2A(ICORE(I0Q(1)),ICORE(I0R(1)),ICORE(I000),MXCOR,IUHF)
        CALL R1L2Y2B(ICORE(I0Q(1)),ICORE(I0R(1)),ICORE(I000),MXCOR,IUHF)
       ENDIF
       CALL R1L2Y2C(ICORE(I0R(1)),ICORE(I000),MXCOR,IUHF)
       CALL R1L2Y2D(ICORE(I0R(1)),ICORE(I000),MXCOR,IUHF)
       CALL R1L2Y2F(ICORE(I0R(1)),ICORE(I000),MXCOR,IUHF)
       CALL R1L2Y2E(ICORE(I0R(1)),ICORE(I000),MXCOR,IUHF)
cc       CALL R1L2Y2G(ICORE(I0R(1)),ICORE(I000),MXCOR,IUHF)
       CALL FORMX4HA(ICORE(I0R(1)),ICORE(I000),MXCOR,IUHF)
       CALL FORMX4HB(ICORE(I0R(1)),ICORE(I000),MXCOR,IUHF)
       CALL R1L2Y2H(ICORE(I0R(1)),ICORE(I000),MXCOR,IUHF)
       CALL RESORT(ICORE(I000),MXCOR,IUHF,IRREPX,444,434)
       CALL RESORT(ICORE(I000),MXCOR,IUHF,IRREPX,461,454)
       IF(.NOT.(MBPT2.OR.LCCD.OR.LCCSD.OR.RCCD.OR.DRCCD.OR.CC2))
     & THEN
        CALL R1L2Y2I(ICORE(I0F(1)),ICORE(I0R(1)),ICORE(I000),MXCOR,IUHF)
        CALL R1L2Y2J(ICORE(I0F(1)),ICORE(I0R(1)),ICORE(I000),MXCOR,IUHF)
        CALL R1L2Y2K(ICORE(I0Q(1)),ICORE(I0F(1)),ICORE(I0R(1)),
     &     ICORE(I000),MXCOR,IUHF)
        CALL R1L2Y2L(ICORE(I0F(1)),ICORE(I0R(1)),ICORE(I000),MXCOR,IUHF)
       ENDIF
      RETURN
      END
