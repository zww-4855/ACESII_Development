
      SUBROUTINE NEWLST(IRREPX,ICORE,MAXCOR,IUHF)
C
C RESETS LISTS FOR A PARTICULAR IRREP
C
      IMPLICIT INTEGER (A-Z)
      LOGICAL CIS,EOMCC,CISD,FULDIAG,INCORE,READGUES,ESPROP,RPA
      LOGICAL MBPT2,CC,CCD,RCCD,DRCCD,LCCD,LCCSD,CC2
      DIMENSION ICORE(MAXCOR)
C
      COMMON/METH/CIS,RPA,EOMCC,CISD,FULDIAG,INCORE,READGUES
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),ID(18)
      COMMON /PROPGRAD/ ESPROP,IOPTROOT,IOPTSYM
      COMMON /EXTRAP/ MAXEXP,NREDUCE,NTOL,NSIZEC
      COMMON /FLAGS/ IFLAGS(100)
      COMMON /REFTYPE/MBPT2,CC,CCD,RCCD,DRCCD,LCCD,LCCSD,CC2
C
C SINGLES LISTS 
C
      DO 5 ISPIN=1,1+IUHF
       T1SIZE=IRPDPD(IRREPX,8+ISPIN)
       ABSIZE=IRPDPD(IRREPX,18+ISPIN)
       IJSIZE=IRPDPD(IRREPX,20+ISPIN)
       call aces_list_resize(ISPIN,490,T1SIZE)
       call aces_list_resize(ISPIN+2,490,T1SIZE)
       call aces_list_resize(9,447+ISPIN,T1SIZE)
       call aces_list_resize(ISPIN,491,IJSIZE)
       call aces_list_resize(ISPIN+2,491,IJSIZE)
       call aces_list_resize(ISPIN,492,ABSIZE)
       call aces_list_resize(ISPIN+2,492,ABSIZE)
       call aces_list_resize(ISPIN,493,T1SIZE)
       call aces_list_resize(ISPIN+2,493,T1SIZE)

C For EOM-CCSD(T); Ajith Perera, 02/2014 (from JDW)

       call aces_list_resize(ISPIN  ,410,T1SIZE)
       call aces_list_resize(ISPIN+2,410,T1SIZE)
       call aces_list_resize(ISPIN+4,410,T1SIZE)

5     CONTINUE
C 
      DO 11 ISPIN=3,3-2*IUHF,-1
C
C T2-SIZE LISTS
C
       TTYPEL=ISYTYP(1,43+ISPIN)
       TTYPER=ISYTYP(2,43+ISPIN)
       IF ((RCCD .OR. DRCCD) .AND. ISPIN .NE.3) THEN
          TTYPEL= ISPIN
          TTYPER= 2 + ISPIN
       ENDIF
       CALL NEWTYP2(IRREPX,443+ISPIN,TTYPEL,TTYPER,.TRUE.)
       CALL NEWTYP2(IRREPX,447+ISPIN,TTYPEL,TTYPER,.TRUE.)
       CALL NEWTYP2(IRREPX,460+ISPIN,TTYPEL,TTYPER,.TRUE.)
       IF(IFLAGS(93).EQ.2)THEN
        CALL NEWTYP2(IRREPX,280+ISPIN,TTYPEL,TTYPER,.TRUE.)
        TTYPEL=15
        CALL NEWTYP2(IRREPX,213+ISPIN,TTYPEL,TTYPER,.TRUE.)
c        CALL NEWTYP2(IRREPX,413+ISPIN,TTYPEL,TTYPER,.TRUE.)
        CALL NEWTYP2(IRREPX,463+ISPIN,TTYPEL,TTYPER,.TRUE.)
       ENDIF
C For EOM-CCSD(T); Ajith Perera, 02/2014 (from JDW)

        CALL NEWTYP2(IRREPX,400+ISPIN,TTYPEL,TTYPER,.TRUE.)
        CALL NEWTYP2(IRREPX,403+ISPIN,TTYPEL,TTYPER,.TRUE.)
        CALL NEWTYP2(IRREPX,406+ISPIN,TTYPEL,TTYPER,.TRUE.)
11    CONTINUE
C
CMN      IF(CIS)RETURN
C
C LISTS USED BY DAVIDSON EXTRAPOLATOR
C
      LEN=0
      DO 10 ISPIN=1,1+IUHF
       LEN=LEN+IRPDPD(IRREPX,8+ISPIN)
10    CONTINUE
      LEN=LEN+IDSYMSZ(IRREPX,ISYTYP(1,446),ISYTYP(2,446))
      IF(IUHF.NE.0)THEN
       LEN=LEN+IDSYMSZ(IRREPX,ISYTYP(1,444),ISYTYP(2,444))
       LEN=LEN+IDSYMSZ(IRREPX,ISYTYP(1,445),ISYTYP(2,445))
      ENDIF
      call aces_list_resize(1,470,LEN)
      call aces_list_resize(1,471,LEN)
      call aces_list_resize(1,472,LEN)
      IF(ESPROP)THEN
      call aces_list_resize(2,470,LEN)
      call aces_list_resize(2,471,LEN)
      call aces_list_resize(2,472,LEN)
      ENDIF
      NSIZEC=LEN
C
C RESORTED LISTS
C
      CALL NEWTYP2(IRREPX,434,ISYTYP(1,434),ISYTYP(2,434),.TRUE.)
      CALL NEWTYP2(IRREPX,437,ISYTYP(1,437),ISYTYP(2,437),.TRUE.)
      CALL NEWTYP2(IRREPX,439,ISYTYP(1,439),ISYTYP(2,439),.TRUE.)
      CALL NEWTYP2(IRREPX,454,ISYTYP(1,454),ISYTYP(2,454),.TRUE.)
      CALL NEWTYP2(IRREPX,457,ISYTYP(1,457),ISYTYP(2,457),.TRUE.)
      CALL NEWTYP2(IRREPX,459,ISYTYP(1,459),ISYTYP(2,459),.TRUE.)
      CALL NEWTYP2(IRREPX,442,ISYTYP(1,442),ISYTYP(2,442),.TRUE.)
      CALL NEWTYP2(IRREPX,443,ISYTYP(1,443),ISYTYP(2,443),.TRUE.)
      CALL NEWTYP2(IRREPX,440,ISYTYP(1,440),ISYTYP(2,440),.TRUE.)
      CALL NEWTYP2(IRREPX,441,ISYTYP(1,441),ISYTYP(2,441),.TRUE.)
      CALL NEWTYP2(IRREPX,426,ISYTYP(1,426),ISYTYP(2,426),.TRUE.)
      CALL NEWTYP2(IRREPX,428,ISYTYP(1,428),ISYTYP(2,428),.TRUE.)
      IF(IUHF.NE.0)THEN
       CALL NEWTYP2(IRREPX,435,ISYTYP(1,435),ISYTYP(2,435),.TRUE.)
       CALL NEWTYP2(IRREPX,436,ISYTYP(1,436),ISYTYP(2,436),.TRUE.)
       CALL NEWTYP2(IRREPX,438,ISYTYP(1,438),ISYTYP(2,438),.TRUE.)
       CALL NEWTYP2(IRREPX,455,ISYTYP(1,455),ISYTYP(2,455),.TRUE.)
       CALL NEWTYP2(IRREPX,456,ISYTYP(1,456),ISYTYP(2,456),.TRUE.)
       CALL NEWTYP2(IRREPX,458,ISYTYP(1,458),ISYTYP(2,458),.TRUE.)
       CALL NEWTYP2(IRREPX,424,ISYTYP(1,424),ISYTYP(2,424),.TRUE.)
       CALL NEWTYP2(IRREPX,425,ISYTYP(1,425),ISYTYP(2,425),.TRUE.)
       CALL NEWTYP2(IRREPX,427,ISYTYP(1,427),ISYTYP(2,427),.TRUE.)
       CALL NEWTYP2(IRREPX,429,ISYTYP(1,429),ISYTYP(2,429),.TRUE.)
      ENDIF
C
C Lists for CCSDT-3, CC3, CCSDT-T1T2, and noniterative
C versions. Ajith Perera, 02/2014 (from JDW); Not needed for 
C EOM-CCSD(T)
C
C      IF( IFLAGS(2).EQ.16.OR.IFLAGS(2).EQ.33.OR.IFLAGS(2).EQ.34.OR.
C     &    IFLAGS(87).EQ.11)THEN
C      IMODE = 0
C
C      IF(IUHF.NE.0)THEN
C        CALL NEWTYP2(IRREPX,377, 3,16,.TRUE.)
C        CALL NEWTYP2(IRREPX,378, 4,17,.TRUE.)
C        CALL NEWTYP2(IRREPX,379,14,11,.TRUE.)
C
C        CALL NEWTYP2(IRREPX,381, 1, 9,.TRUE.)
C        CALL NEWTYP2(IRREPX,382, 2,10,.TRUE.)
C        CALL NEWTYP2(IRREPX,383,13,18,.TRUE.)
C      ENDIF
C
C        CALL NEWTYP2(IRREPX,380,14,18,.TRUE.)
C        CALL NEWTYP2(IRREPX,384,13,11,.TRUE.)
C
C      WRITE(6,*) ' @NEWLST-I, Resetting mcjk lists 377-380 '
C      WRITE(6,*) ' @NEWLST-I, Resetting abci lists 381-384 '
C      ENDIF
C
      RETURN
      END
